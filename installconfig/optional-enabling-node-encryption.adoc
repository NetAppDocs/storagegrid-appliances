---
permalink: installconfig/optional-enabling-node-encryption.html
sidebar: sidebar
keywords: node encryption, encryption, kms, key management server, drive encryption, self-encrypting drives, sed, full-disk encryption, fde
summary: 'You can enable encryption at the node or disk level to protect the disks in your appliance against physical loss or removal from the site.'
---
= Optional: Enable node or drive encryption
:icons: font
:imagesdir: ../media/

[.lead]
You can enable encryption at the node or disk level to protect the disks in your appliance against physical loss or removal from the site.

* <<Enable node encryption,Node encryption>> protects all disks in the appliance using secure key management server (KMS) encryption. It is a software encryption performed by appliance software.
* <<Enable drive encryption,Drive encryption>> protects disks in the appliance that are specifically designed as Self-Encrypting Drives (SED). It can also be used on Full-disk encryption (FDE) drives which are qualified for a higher level of security. Drive encryption secures data with a user-defined passphrase and is performed within each drive.

You can perform both encryption levels on supported drives for additional security.

== Enable node encryption

If you enable node encryption, the disks in your appliance can be protected by secure key management server (KMS) encryption against physical loss or removal from the site. You must select and enable node encryption during appliance installation. You can't disable node encryption after the KMS encryption process starts.

If you are using ConfigBuilder to generate a JSON file, you can enable node encryption automatically. See link:automating-appliance-installation-and-configuration.html[Automate appliance installation and configuration].

.Before you begin

Review the information about https://review.docs.netapp.com/us-en/storagegrid-118_main/admin/kms-configuring.html[configuring KMS^].

.About this task

An appliance that has node encryption enabled connects to the external key management server (KMS) that is configured for the StorageGRID site. Each KMS (or KMS cluster) manages the encryption keys for all appliance nodes at the site. These keys encrypt and decrypt the data on each disk in an appliance that has node encryption enabled.

A KMS can be set up in Grid Manager before or after the appliance is installed in StorageGRID. See the information about KMS and appliance configuration in the instructions for administering StorageGRID for additional details.

* If a KMS is set up before installing the appliance, KMS-controlled encryption begins when you enable node encryption on the appliance and add it to a StorageGRID site where KMS is configured.
* If a KMS is not set up before you install the appliance, KMS-controlled encryption is performed on each appliance that has node encryption enabled as soon as a KMS is configured and available for the site that contains the appliance node.

CAUTION: When an appliance is installed with node encryption enabled, a temporary key is assigned. The data on the appliance is not protected until the appliance is connected to the Key Management System (KMS) and a KMS security key is set. See the https://review.docs.netapp.com/us-en/storagegrid-118_main/admin/kms-overview-of-kms-and-appliance-configuration.html[KMS appliance configuration overview^] for additional information.

Without the KMS key needed to decrypt the disk, data on the appliance can't be retrieved and is effectively lost. This is the case whenever the decryption key can't be retrieved from the KMS. The key becomes inaccessible if a customer clears the KMS configuration, a KMS key expires, connection to the KMS is lost, or the appliance is removed from the StorageGRID system where its KMS keys are installed.

.Steps

. Open a browser, and enter one of the IP addresses for the appliance's compute controller.
+
`*https://_Controller_IP_:8443*`
+
`_Controller_IP_` is the IP address of the compute controller (not the storage controller) on any of the three StorageGRID networks.
+
The StorageGRID Appliance Installer Home page appears.
+
CAUTION: After the appliance has been encrypted with a KMS key, the appliance disks can't be decrypted without using the same KMS key.

. Select *Configure Hardware* > *Node Encryption*.
+
image::../media/kms_fde_enabled.png[KMS FDE enabled]

. Select *Enable node encryption*.
+
Before appliance installation, you can clear *Enable node encryption* without risk of data loss. When the installation begins, the appliance node accesses the KMS encryption keys in your StorageGRID system and begins disk encryption. You can't disable node encryption after the appliance is installed.
+
CAUTION: After you add an appliance that has node encryption enabled to a StorageGRID site that has a KMS, you can't stop using KMS encryption for the node.

. Select *Save*.
. Deploy the appliance as a node in your StorageGRID system.
+
KMS-controlled encryption begins when the appliance accesses the KMS keys configured for your StorageGRID site. The installer displays progress messages during the KMS encryption process, which might take a few minutes depending on the number of disk volumes in the appliance.
+
NOTE: Appliances are initially configured with a random non-KMS encryption key assigned to each disk volume. The disks are encrypted using this temporary encryption key, that is not secure, until the appliance that has node encryption enabled accesses the KMS keys configured for your StorageGRID site.

.After you finish

You can view node-encryption status, KMS details, and the certificates in use when the appliance node is in maintenance mode. See link:../commonhardware/monitoring-node-encryption-in-maintenance-mode.html[Monitor node encryption in maintenance mode] for information.

== Enable drive encryption

Drive encryption is managed on SED and FDE disk drives during the write and read processes. Access to data on these drives is controlled by a user-defined passphrase. 

After the first time the passphrase is entered to enable drive encryption or to reestablish drive access, the passphrase is stored on the StorageGRID appliance. This allows the drive to be accessed without manually renentering the passphrase. If the appliance is replaced or if the drives are moved to a new appliance, the passphrase will need to be manually reentered.

CAUTION: Make sure that you store the drive-encryption passphrase in a secure location. Encrypted drives can't be accessed without manually entering the same passphrase if the drive is installed in another StorageGRID appliance.

.Before you begin

Review the information about https://review.docs.netapp.com/us-en/storagegrid-118_main/admin/reviewing-storagegrid-encryption-methods.html[StorageGRID encryption methods^].

.About this task

Drives encrypted with an SDE passphrase can be accessed by anyone who knows the passphrase. The passphrase unlocks encrypted drives when a StorageGRID appliance restarts. 

The passphrase is established when drive encryption is initially enabled. StorageGRID appliances will retain the passphrase for future use with encrypted drives that remain in the appliance. If the drives are moved or installed in a new StorageGRID appliance, the passphrase will need to be manually reentered.

.Steps

MORGAN'S DEMO

.After you finish

You can view drive-encryption status TBD. See link:../TBD[TBD] for information.

// 2023 SEP 8, SGRIDDOC-18